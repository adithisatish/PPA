SELECT COUNT(driver.driver_id) FROM driver JOIN (SELECT lisence_plate FROM car WHERE curr_condition >= 5) AS n1 ON driver.lisence_plate = n1.lisence_plate AND avg_ratings <=3
SELECT COUNT(card_.card_num) FROM card_ JOIN (SELECT card_num FROM passenger WHERE fname LIKE '%a%') AS n1 ON card_.card_num = n1.card_num AND exp_date > '2020-01-01' AND exp_date < '2021-01-01'
SELECT COUNT(driver.driver_id) FROM driver JOIN (SELECT driver_id FROM completeride WHERE price > 50) AS n1 ON driver.driver_id = n1.driver_id AND avg_ratings > 4
SELECT COUNT(driver.driver_id) FROM driver JOIN (SELECT lisence_plate FROM car JOIN (SELECT model_id FROM size_x WHERE model_name = 'Mercedes E-class') AS n2 ON car.model_id = n2.model_id) AS n1 ON driver.lisence_plate = n1.lisence_plate AND avg_ratings = 5
SELECT COUNT(driver.driver_id) FROM driver JOIN (SELECT lisence_plate FROM car JOIN (SELECT model_id FROM size_x WHERE model_year = 2001) AS n2 ON car.model_id = n2.model_id) AS n1 ON driver.lisence_plate = n1.lisence_plate AND working_hours <=3
SELECT COUNT(completeride.driver_id) FROM completeride JOIN (SELECT driver_id FROM driver JOIN (SELECT lisence_plate FROM car WHERE model_ID = '3INOX77MLSV9766838') AS n2 ON driver.lisence_plate = n2.lisence_plate) AS n1 ON completeride.driver_id = n1.driver_id AND price > 40
SELECT COUNT(driver.driver_id) FROM driver JOIN (SELECT lisence_plate FROM car JOIN (SELECT model_id FROM size_x WHERE model_name LIKE '%Toyota%')AS n2 ON car.model_id = n2.model_id)AS n1 ON driver.lisence_plate = n1.lisence_plate AND working_hours > 8
SELECT COUNT(price) FROM (SELECT price FROM (SELECT price, total_distance FROM completeride WHERE pickup_location like '%Mott Haven%')AS n1 WHERE total_distance > 10) AS n2 WHERE price > 10
SELECT COUNT(completeride.driver_id) FROM completeride JOIN (SELECT driver_id FROM driver JOIN ( SELECT lisence_plate FROM car JOIN (SELECT model_id FROM size_x WHERE model_name = 'Mercedes E-class')AS n3 ON car.model_id=n3.model_id)AS n2 ON driver.lisence_plate=n2.lisence_plate)AS n1 ON completeride.driver_id=n1.driver_id AND price>60
SELECT COUNT(completeride.driver_id) FROM completeride JOIN (SELECT driver_id FROM driver JOIN (SELECT lisence_plate FROM car JOIN (SELECT model_id FROM size_x WHERE model_name LIKE '%Hyundai%')AS n3 ON car.model_id = n3.model_id) AS n2 ON driver.lisence_plate=n2.lisence_plate) AS n1 ON completeride.driver_id=n1.driver_id AND pickup_location LIKE '%South Bronx%'
SELECT COUNT(completeride.driver_id) FROM completeride JOIN (SELECT driver_id FROM driver JOIN (SELECT lisence_plate FROM car JOIN (SELECT model_id FROM size_x WHERE model_year = 2010) AS n3 ON car.model_id=n3.model_id) AS n2 ON driver.lisence_plate=n2.lisence_plate) AS n1 ON completeride.driver_id=n1.driver_id AND total_distance > 50
SELECT COUNT(passenger.passenger_id) FROM passenger JOIN (SELECT passenger_id FROM completeride JOIN (SELECT driver_id FROM driver JOIN (SELECT lisence_plate FROM car WHERE curr_condition = 4) AS n3 ON driver.lisence_plate = n3.lisence_plate) AS n2 ON completeride.driver_id=n2.driver_id) AS n1 ON passenger.passenger_id=n1.passenger_id AND fname LIKE 'a%'
SELECT COUNT(price) FROM (SELECT completeride.driver_id, completeride.price FROM completeride JOIN (SELECT driver_id FROM driver JOIN (SELECT lisence_plate FROM car JOIN (SELECT model_id FROM size_x WHERE model_year = 2010) AS n3 ON car.model_id=n3.model_id) AS n2 ON driver.lisence_plate=n2.lisence_plate) AS n1 ON completeride.driver_id=n1.driver_id AND total_distance > 20)AS n1 WHERE price>60
SELECT model_name FROM size_x JOIN (SELECT model_id FROM car WHERE purchase_date > '2009-12-31' AND purchase_date < '2011-01-01') AS n1 ON size_x.model_id=n1.model_id GROUP BY model_name ORDER BY COUNT(model_name) DESC LIMIT 1
SELECT COUNT(n1.driver_id) FROM (SELECT driver_id, AVG(total_distance) FROM completeride GROUP BY driver_id)AS n1 JOIN (SELECT driver_id, SUM(price) FROM completeride GROUP BY driver_id) AS n2 ON n1.driver_id=n2.driver_id WHERE AVG>20 AND SUM>300
SELECT COUNT(n1.driver_id) FROM (SELECT driver_id, working_hours FROM driver)AS n1 JOIN (SELECT driver_id, SUM(price) FROM completeride GROUP BY driver_id) AS n2 ON n1.driver_id=n2.driver_id AND n1.working_hours>8 AND n2.SUM>400
SELECT AVG(working_hours) FROM driver JOIN (SELECT driver_id FROM driver JOIN (SELECT lisence_plate FROM car JOIN (SELECT model_id FROM size_x WHERE model_name='Mercedes E-class')AS n3 ON car.model_id=n3.model_id)AS n2 ON driver.lisence_plate=n2.lisence_plate)AS n1 ON driver.driver_id=n1.driver_id
SELECT MAX(avg) FROM (SELECT AVG(total_distance) FROM completeride JOIN (SELECT driver_id FROM driver JOIN (SELECT lisence_plate FROM car JOIN (SELECT model_id FROM size_x WHERE model_name='Mercedes E-class') AS n4 ON car.model_id=n4.model_id) AS n3 ON driver.lisence_plate=n3.lisence_plate) AS n2 ON completeride.driver_id=n2.driver_id GROUP BY completeride.driver_id) AS n1
